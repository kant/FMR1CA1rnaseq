---
title: "Behavior Data Analysis"
author: "Rayna M Harris"
date: "Last updated November 22, 2017"
output: md_document
---

# Setup - load libraries and favorite colors

```{r setup, message=F}
## load libraries 
library(tidyr) ## for respahing data
library(plyr) ## for renmaing factors
library(dplyr) ## for filtering and selecting rows
library(reshape2) ## for melting dataframe
library(ggplot2)
library(cowplot)
library(pheatmap)
library(viridis)
library(ez) # for non-parametric ANOVA

## load color settings
source("figureoptions.R")

knitr::opts_chunk$set(fig.path = '../figures/01_behavior/')
```

# Behavior data wrangling and sample sizes

![](../figures/fig1-01.png)

```{r behaivordata, message=F}
## read intermediate data (raw data from video tracker program analyzed in matlab)
behavior <- read.csv("../data/fmr1.csv", header = T)

behavior$APA <- as.factor(behavior$APA)
behavior$APA2 <- as.factor(behavior$APA2)


## relevel then rename factors treatment
behavior$APA2 <- factor(behavior$APA2, levels = c("controlconsistent", "consistent", "controlconflict", "conflict"))
levels(behavior$APA2) <- c("yoked-consistent","consistent", "yoked-conflict","conflict")
levels(behavior$APA2)

#relevel genotype
levels(behavior$Genotype) <- c("WT","FMR1KO")
#levels(behavior$conflict) <- c("consistent","conflict")

behavior$Time1stEntrLog <- log(behavior$Time1stEntr)  ## log transformation
behavior$conflict <- ifelse(grepl("conflict", behavior$APA2), "conflict", "consistent") # for splitting
levels(behavior$conflict) <- c("consistent","conflict")
behavior <- behavior[c(1,3,7,8,10,60,14:59)] # supset data
behavior <- subset(behavior, !is.na(behavior$NumEntrances)) # remove nas

# sample sizes
behavior %>% 
  filter(TrainSessionCombo == "Retention", Genotype == "WT") %>%
  select(APA2, Genotype)  %>%  summary()

behavior %>% 
  filter(TrainSessionCombo == "Retention", Genotype == "FMR1KO") %>%
  select(APA2, Genotype)  %>%  summary()
```

# General overview of number of entrances to the shock zone and path to the first entrance. No statistics on these full data sets because its makes more sense to subset the data into training and non-training sessions first.

![](../figures/fig1-02.png)

```{r}
# behaviors
numentr <- dplyr::summarise(group_by(behavior, Genotype, APA2, TrainSessionComboNum, conflict), m = mean(NumEntrances), se = sd(NumEntrances)/sqrt(length(NumEntrances)), len = length(NumEntrances))

pathentr <- dplyr::summarise(group_by(behavior, Genotype, APA2, TrainSessionComboNum, conflict), m = mean(Path1stEntr), se = sd(Path1stEntr)/sqrt(length(Path1stEntr)), len = length(Path1stEntr))

levels(numentr$APA2) <- c("yoked-consistent","consistent", "yoked-conflict","conflict")
levels(pathentr$APA2) <- c("yoked-consistent","consistent", "yoked-conflict","conflict")

numentr$conflict = factor(numentr$conflict, levels = c("consistent","conflict"))
pathentr$conflict = factor(numentr$conflict, levels = c("consistent","conflict"))
numentr$measure <- "Number of Entrances"
pathentr$measure <- "Path to the 1st Entrance"

PathNum <- rbind(pathentr,numentr)
PathNum$measure <- as.factor(PathNum$measure)
write.csv(PathNum, "../data/01_behaviordatasummary.csv")


PathNumStats <- behavior  %>% 
  filter(Genotype == "WT", TrainSessionComboNum == "6") 
summary(aov(NumEntrances ~  APA2, data=PathNumStats))
TukeyHSD(aov(NumEntrances ~  APA2, data=PathNumStats))
summary(aov(Path1stEntr ~  APA2, data=PathNumStats))
TukeyHSD(aov(Path1stEntr ~  APA2, data=PathNumStats))

PathNumStats <- behavior  %>% 
  filter(Genotype == "WT", TrainSessionComboNum == "8") 
summary(aov(NumEntrances ~  APA2, data=PathNumStats))
TukeyHSD(aov(NumEntrances ~  APA2, data=PathNumStats))
summary(aov(Path1stEntr ~  APA2, data=PathNumStats))
TukeyHSD(aov(Path1stEntr ~  APA2, data=PathNumStats))

PathNumStats <- behavior  %>% 
  filter(Genotype == "WT", TrainSessionComboNum == "4") 
summary(aov(NumEntrances ~  APA2, data=PathNumStats))
TukeyHSD(aov(NumEntrances ~  APA2, data=PathNumStats))
summary(aov(Path1stEntr ~  APA2, data=PathNumStats))
TukeyHSD(aov(Path1stEntr ~  APA2, data=PathNumStats))




numenrwt <- PathNum  %>% 
  #filter(TrainSessionComboNum != "1", TrainSessionComboNum != "9") %>% 
  filter(measure == "Number of Entrances") %>% 
  filter(Genotype == "WT") %>% 
  droplevels()  %>% 
  ggplot(aes(x=, TrainSessionComboNum, y=m, color=APA2, shape=Genotype)) + 
    geom_errorbar(aes(ymin=m-se, ymax=m+se), width=.1) +
    geom_point(size = 2) +
   geom_line(aes(colour=APA2, linetype=Genotype)) +
   scale_y_continuous(name= "Number of Entrances",
                      limits = c(0,35)) +
    scale_x_continuous(name="Training Session", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = c( "Pre.", "T1", "T2", "T3",
                                   "Retest", "C1", "C2" ,"C3", 
                                   "Reten.")) +
  theme_cowplot(font_size = 8, line_size = 0.25) +
  background_grid(major = "y", minor="non") +
  scale_color_manual(values = colorvalAPA00)  +
  theme(legend.title=element_blank()) +
  theme(legend.position="none") +
  scale_shape_manual(values=c(16, 1)) 
numenrwt

pdf(file="../figures/01_behavior/numenrwt.pdf", width=2.25, height=2)
plot(numenrwt)
dev.off()

numenrfmr1 <- PathNum  %>% 
  filter(TrainSessionComboNum != "1", TrainSessionComboNum != "9") %>% 
  filter(measure == "Number of Entrances") %>% 
  filter(Genotype != "WT") %>% 
  ggplot(aes(x=, TrainSessionComboNum, y=m, color=APA2, shape=Genotype)) + 
    geom_errorbar(aes(ymin=m-se, ymax=m+se), width=.1) +
    geom_point(size = 2) +
   geom_line(linetype = 2, aes(colour=APA2)) +
   scale_y_continuous(name= "Number of Entrances",
                      limits = c(0,35)) +
    scale_x_continuous(name="Training Session", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = c( "Pre.", "T1", "T2", "T3",
                                   "Retest", "C1", "C2","C3", 
                                  "Reten.")) +
  theme_cowplot(font_size = 8, line_size = 0.25) +
  background_grid(major = "y", minor = "none") +
  scale_color_manual(values = colorvalAPA00)  +
  theme(legend.title=element_blank()) +
  theme(legend.position="none") +
  scale_shape_manual(values=c(1)) 
numenrfmr1


pdf(file="../figures/01_behavior/numenrfmr1.pdf", width=2.25, height=2)
plot(numenrfmr1)
dev.off()


pathfmr1 <- PathNum  %>% 
  #filter(TrainSessionComboNum != "1", TrainSessionComboNum != "9") %>% 
  filter(measure == "Path to the 1st Entrance") %>% 
  filter(Genotype != "WT") %>% 
  ggplot(aes(x=, TrainSessionComboNum, y=m, color=APA2, shape=Genotype)) + 
    geom_errorbar(aes(ymin=m-se, ymax=m+se), width=.1) +
    geom_point(size = 2) +
   geom_line(linetype = 2, aes(colour=APA2)) +
   scale_y_continuous(name= "Path to the 1st Entrance",
                      limits = c(0,17.5)) +
    scale_x_continuous(name="Training Session", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = c( "Pre.", "T1", "T2", "T3",
                                   "Retest", "C1", "C2", "C3", 
                                    "Reten.")) +
  theme_cowplot(font_size = 8, line_size = 0.25) +
  background_grid(major = "y", minor = "none") +
  scale_color_manual(values = colorvalAPA00)  +
  theme(legend.title=element_blank()) +
  theme(legend.position="none") +
  scale_shape_manual(values=c(1)) 
pathfmr1

pdf(file="../figures/01_behavior/pathfmr1.pdf", width=2.25, height=2)
plot(pathfmr1)
dev.off()

pathwt <- PathNum  %>% 
  #filter(TrainSessionComboNum != "1", TrainSessionComboNum != "9") %>% 
  filter(measure == "Path to the 1st Entrance") %>% 
  filter(Genotype == "WT") %>% 
  ggplot(aes(x=, TrainSessionComboNum, y=m, color=APA2, shape=Genotype)) + 
    geom_errorbar(aes(ymin=m-se, ymax=m+se), width=.1) +
    geom_point(size = 2) +
   geom_line(linetype = 1, aes(colour=APA2)) +
   scale_y_continuous(name= "Path to the 1st Entrance",
                      limits = c(0,17.5)) +
    scale_x_continuous(name="Training Session", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = c( "Pre.", "T1", "T2", "T3",
                                   "Retest", "C1", "C2","C3", 
                                   "Reten.")) +
  theme_cowplot(font_size = 8, line_size = 0.25) +
  background_grid(major = "y", minor = "none") +
  scale_color_manual(values = colorvalAPA00)  +
  theme(legend.title=element_blank()) +
  theme(legend.position="none") +
  scale_shape_manual(values=c(16)) 
pathwt

pdf(file="../figures/01_behavior/pathwt.pdf", width=2.25, height=2)
plot(pathwt)
dev.off()

```


# Proption time spent before training
During the pre-training trial, all groups spend an equal amount of time in all quadrants of the arena. 

![](../figures/fig1-04.png)

```{r}
PathNumStats <- behavior  %>% 
  filter(TrainSessionComboNum == "1") 
summary(aov(pTimeTarget ~  APA2 * Genotype, data=PathNumStats))
summary(aov(pTimeOPP ~  APA2 * Genotype, data=PathNumStats))
summary(aov(pTimeCW ~  APA2 * Genotype, data=PathNumStats))
summary(aov(pTimeCCW ~  APA2 * Genotype, data=PathNumStats))

```

# Where do mice spend their time? 
Again this first graph is a big overview that shows that consistent trained aniamls avoid the shock zone and the clockwise area while conflict avoid the shock zone and counter clockwise. This is re-illustrated in the subsequent graph focusing just on the conlict training sessions. Yoked mice show no place preference or avoidance.

![](../figures/fig1-06.png)


```{r}

proptime <- behavior[,c(1,2,4,8,9,12,26:29)]
proptime <- melt(proptime, id.vars = c("ID", "Genotype", "TrainSession",
                                       "APA2", "TrainSessionCombo","TrainSessionComboNum")) 

timespent1 <- proptime %>%
  filter(APA2 %in% c("consistent","conflict")) %>%
  filter(TrainSessionComboNum != 1) %>%
  ggplot(aes(x = TrainSessionComboNum, y = value,fill = variable)) + 
    geom_bar(position = "fill",stat = "identity") +
    scale_x_continuous(name="Training Session", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = c( "P", "T1", "T2", "T3",
                                   "Rt", "C1", "C2","C3", 
                                   "Rn")) +
  facet_wrap(~APA2*Genotype, nrow=1) +
  theme_cowplot(font_size = 8, line_size = 0.25) +  theme(legend.title=element_blank()) +
    theme(legend.position="none") +
  scale_y_continuous(name= "Proportion of Time Spent",
                     breaks = c(0.32,0.64, 0.96)) +
  scale_fill_manual(values = c("#de2d26", "#e5f5e0" ,"#a1d99b", "#31a354")) + 
  geom_hline(yintercept=c(0.32,0.64, 0.96), color="black" , linetype="dashed") 
timespent1

timespent2 <- proptime %>%
  filter(APA2 %in% c("yoked-consistent","yoked-conflict")) %>%
    filter(TrainSessionComboNum != 1) %>%
  ggplot(aes(x = TrainSessionComboNum, y = value,fill = variable)) + 
    geom_bar(position = "fill",stat = "identity") +
    scale_x_continuous(name="Training Session", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = c( "P", "T1", "T2", "T3",
                                   "Rt", "C1", "C2","C3", 
                                   "Rn")) +
  facet_wrap(~APA2*Genotype, nrow=1) +
  theme_cowplot(font_size = 8, line_size = 0.25) +
  theme(legend.title=element_blank()) +
  theme(legend.position="none") +
  scale_y_continuous(name= "Proportion of Time Spent") +
  scale_fill_manual(values = c("#de2d26", "#e5f5e0" ,"#a1d99b", "#31a354")) + 
  geom_hline(yintercept=c(0.25,0.50, 0.75), color="black" , linetype="dashed")
timespent2

pdf(file="../figures/01_behavior/timespent1.pdf", width=6, height=2.25)
plot(timespent1)
dev.off()

pdf(file="../figures/01_behavior/timespent2.pdf", width=6, height=2.25)
plot(timespent2)
dev.off()


timespent3 <- proptime %>%
  #filter(APA2 %in% c("yoked-consistent","yoked-conflict")) %>%
  filter(TrainSessionComboNum %in% c("1")) %>%
  ggplot(aes(x = APA2, y = value,fill = variable)) + 
    geom_bar(position = "fill",stat = "identity") +
    scale_x_discrete(name="Pre-training Proportion of Time Spent",
                     labels = c("yoked", "consistent", "yoked", "conflict")) +
  facet_wrap(~Genotype, nrow=1) +
  theme_cowplot(font_size = 8, line_size = 0.25) +
  theme(legend.title=element_blank()) +
  theme(legend.position="none") +
  scale_y_continuous(name= "Proportion of Time Spent") +
  scale_fill_manual(values = c("#de2d26", "#e5f5e0" ,"#a1d99b", "#31a354")) + 
  geom_hline(yintercept=c(0.25,0.50, 0.75), color="black" , linetype="dashed") +
  theme(strip.text.x = element_text(size = 8)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
timespent3


pdf(file="../figures/01_behavior/timespent3.pdf", width=3, height=2.25)
plot(timespent3)
dev.off()

timespent4 <- proptime %>%
  filter(APA2 %in% c("yoked-consistent","yoked-conflict")) %>%
  filter(TrainSessionComboNum %in% c("9")) %>%
  ggplot(aes(x = APA2, y = value,fill = variable)) + 
    geom_bar(position = "fill",stat = "identity") +
    scale_x_discrete(name="Retention Proportion of Time Spent") +
  facet_wrap(~Genotype, nrow=1) +
  theme_cowplot(font_size = 8, line_size = 0.25) +
  theme(legend.title=element_blank()) +
  theme(legend.position="none") +
  scale_y_continuous(name= "Proportion of Time Spent") +
  scale_fill_manual(values = c("#de2d26", "#e5f5e0" ,"#a1d99b", "#31a354")) + 
    geom_hline(yintercept=c(0.25,0.50, 0.75), color="black" , linetype="dashed") +
  theme(strip.text.x = element_text(size = 8)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
timespent4

timespent5 <- proptime %>%
  filter(APA2 %in% c("consistent","conflict")) %>%
  filter(TrainSessionComboNum %in% c("9")) %>%
  ggplot(aes(x = APA2, y = value,fill = variable)) + 
    geom_bar(position = "fill",stat = "identity") +
    scale_x_discrete(name="Retention Proportion of Time Spent") +
  facet_wrap(~Genotype, nrow=1) +
  theme_cowplot(font_size = 8, line_size = 0.25) +
  theme(legend.title=element_blank()) +
  theme(legend.position="none") +
  scale_y_continuous(name= "Proportion of Time Spent",
                     breaks = c(0.30,0.60, 0.90)) +
  scale_fill_manual(values = c("#de2d26", "#e5f5e0" ,"#a1d99b", "#31a354")) + 
  geom_hline(yintercept=c(0.30,0.60, 0.90), color="black" , linetype="dashed") +
  theme(strip.text.x = element_text(size = 8)) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
timespent5

pdf(file="../figures/01_behavior/timespent4.pdf", width=1.75, height=2.25)
plot(timespent4)
dev.off()

pdf(file="../figures/01_behavior/timespent5.pdf", width=1.75, height=2.25)
plot(timespent5)
dev.off()


```

# Now - exampine space use interaction APA2 * Genotype in trained and yoked separated

![](../figures/fig1-05.png)

```{r proportiontimespenttrained}

trainedtimespent <- behavior %>%
  filter(APA2 %in% c("consistent","conflict")) %>%
    filter(TrainSessionComboNum %in% c("6", "7", "8"))
head(trainedtimespent)

summary(aov(data =  trainedtimespent, pTimeTarget ~ Genotype * APA2 ))
#Genotype       1 0.00065 0.0006531   1.179  0.281
#APA2           1 0.00035 0.0003529   0.637  0.427
#Genotype:APA2  1 0.00033 0.0003310   0.597  0.442

summary(aov(data =  trainedtimespent, pTimeCW ~ Genotype * APA2 ))
#Genotype       1 0.0000  0.0000   0.001    0.982    
#APA2           1 0.8791  0.8791  38.375 2.56e-08 ***
#Genotype:APA2  1 0.0006  0.0006   0.027    0.871 
TukeyHSD(aov(data =  trainedtimespent, pTimeCW ~ Genotype * APA2 ))
#FMR1KO:consistent-WT:consistent   0.02397566 -0.09804438 0.1459957 0.9550673
#WT:conflict-WT:consistent         0.20514213  0.09366727 0.3166170 0.0000389
#FMR1KO:conflict-WT:consistent     0.24057083  0.10008441 0.3810573 0.0001379
#WT:conflict-FMR1KO:consistent     0.18116647  0.06217945 0.3001535 0.0008182
#FMR1KO:conflict-FMR1KO:consistent 0.21659518  0.07007657 0.3631138 0.0012165
#FMR1KO:conflict-WT:conflict       0.03542870 -0.10243157 0.1732890 0.9063729

summary(aov(data =  trainedtimespent, pTimeOPP ~ Genotype * APA2 ))
#Genotype       1 0.0617 0.06168   2.146  0.147
#APA2           1 0.0309 0.03088   1.074  0.303
#Genotype:APA2  1 0.0634 0.06339   2.206  0.142

summary(aov(data =  trainedtimespent, pTimeCCW ~ Genotype * APA2 ))
#Genotype       1 0.0512  0.0512   1.963    0.165    
#APA2           1 0.6094  0.6094  23.366 6.58e-06 ***
#Genotype:APA2  1 0.0668  0.0668   2.560    0.114 


TukeyHSD(aov(data =  trainedtimespent, pTimeCCW ~ Genotype * APA2 ))
#FMR1KO:consistent-WT:consistent    0.07931096 -0.05087865  0.20950058 0.3850072
#WT:conflict-WT:consistent         -0.13039352 -0.24933193 -0.01145511 0.0259978
#FMR1KO:conflict-WT:consistent     -0.17080833 -0.32070071 -0.02091596 0.0190587
#WT:conflict-FMR1KO:consistent     -0.20970448 -0.33665801 -0.08275096 0.0002467
#FMR1KO:conflict-FMR1KO:consistent -0.25011930 -0.40644773 -0.09379087 0.0004019
#FMR1KO:conflict-WT:conflict       -0.04041481 -0.18750522  0.10667559 0.8883106


timeccw <- behavior %>%
  filter(APA2 %in% c("consistent","conflict")) %>%
    filter(TrainSessionComboNum %in% c("6", "7", "8")) %>% 
  ggplot(aes(x = as.numeric(TrainSessionComboNum), y = pTimeCCW, fill=APA2)) +
  geom_boxplot(outlier.size=0.8) +
  facet_wrap(~Genotype) +
  scale_fill_manual(values = c("#ca0020", "#f4a582")) +  
 scale_x_continuous(name="C1-C3 Average", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = NULL) +
  geom_hline(yintercept=c(0.32), color="black" , linetype="dashed") + 
    scale_y_continuous(name = "Counter Clockwise",
      breaks = c(0,0.32, 0.64),
                     limits= c(0,0.8)) +
  theme_cowplot(font_size = 8, line_size = 0.25) +
  theme(legend.position="none")
timeccw

timecw <- behavior %>%
  filter(APA2 %in% c("consistent","conflict")) %>%
    filter(TrainSessionComboNum %in% c("6", "7", "8")) %>% 
  ggplot(aes(x = as.numeric(TrainSessionComboNum), y = pTimeCW, fill=APA2)) +
  geom_boxplot(outlier.size=0.8) +
  facet_wrap(~Genotype) +
  scale_fill_manual(values = c("#ca0020", "#f4a582")) +  
 scale_x_continuous(name="C1-C3 Average", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = NULL) +
  geom_hline(yintercept=c(0.32), color="black" , linetype="dashed") + 
    scale_y_continuous(name = "Clockwise",
                       breaks = c(0,0.32, 0.64),
                     limits= c(0,0.8)) +
  theme_cowplot(font_size = 8, line_size = 0.25) +
 theme(legend.position="none")
timecw

timet <- behavior %>%
  filter(APA2 %in% c("consistent","conflict")) %>%
    filter(TrainSessionComboNum %in% c("6", "7", "8")) %>% 
  ggplot(aes(x = as.numeric(TrainSessionComboNum), y = pTimeTarget, fill=APA2)) +
  geom_boxplot(outlier.size=0.8) +
  facet_wrap(~Genotype) +
  scale_fill_manual(values = c("#ca0020", "#f4a582")) +  
 scale_x_continuous(name="C1-C3 Average", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = NULL) +
    scale_y_continuous(name = "Shock zone",
                       breaks = c(0,0.04, 0.08, 0.12),
                         limits= c(0,0.14)) +
  #geom_hline(yintercept=c(0.04), color="black" , linetype="dashed") + 
  theme_cowplot(font_size = 8, line_size = 0.25) +
 theme(legend.position="none")
timet

timeopp <- behavior %>%
  filter(APA2 %in% c("consistent","conflict")) %>%
    filter(TrainSessionComboNum %in% c("6", "7", "8")) %>% 
  ggplot(aes(x = as.numeric(TrainSessionComboNum), y = pTimeOPP, fill=APA2)) +
  geom_boxplot(outlier.size=0.8) +
  facet_wrap(~Genotype) +
  scale_fill_manual(values = c("#ca0020", "#f4a582")) + 
    scale_y_continuous(name = "Opposite the shock zone",
                       breaks = c(0,0.32, 0.64),
                     limits= c(0,0.8)) +
 scale_x_continuous(name="C1-C3 Average", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = NULL) +
  geom_hline(yintercept=c(0.32), color="black" , linetype="dashed") + 
  theme_cowplot(font_size = 8, line_size = 0.25) +
 theme(legend.position="none")
timeopp

pdf(file="../figures/01_behavior/timecw.pdf", width=1.5, height=2)
plot(timecw)
dev.off()
pdf(file="../figures/01_behavior/timeccw.pdf", width=1.5, height=2)
plot(timeccw)
dev.off()

pdf(file="../figures/01_behavior/timet.pdf", width=1.5, height=2)
plot(timet)
dev.off()
pdf(file="../figures/01_behavior/timeopp.pdf", width=1.5, height=2)
plot(timeopp)
dev.off()

timeccw <- behavior %>%
  filter(APA2 %in% c("consistent","conflict")) %>%
    filter(TrainSessionComboNum %in% c("2", "3", "4")) %>% 
  ggplot(aes(x = as.numeric(TrainSessionComboNum), y = pTimeCCW, fill=APA2)) +
  geom_boxplot(outlier.size=0.8) +
  facet_wrap(~Genotype) +
  scale_fill_manual(values = c("#ca0020", "#f4a582")) +  
 scale_x_continuous(name="T1-T3 Average", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = NULL) +
  geom_hline(yintercept=c(0.32), color="black" , linetype="dashed") + 
    scale_y_continuous(name = "Counter Clockwise",
      breaks = c(0,0.32, 0.64),
                     limits= c(0,0.8)) +
  theme_cowplot(font_size = 8, line_size = 0.25) +
  theme(legend.position="none")
timeccw

timecw <- behavior %>%
  filter(APA2 %in% c("consistent","conflict")) %>%
    filter(TrainSessionComboNum %in% c("2", "3", "4")) %>% 
  ggplot(aes(x = as.numeric(TrainSessionComboNum), y = pTimeCW, fill=APA2)) +
  geom_boxplot(outlier.size=0.8) +
  facet_wrap(~Genotype) +
  scale_fill_manual(values = c("#ca0020", "#f4a582")) +  
 scale_x_continuous(name="T1-T3 Average", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = NULL) +
  geom_hline(yintercept=c(0.32), color="black" , linetype="dashed") + 
    scale_y_continuous(name = "Counter Clockwise",
      breaks = c(0,0.32, 0.64),
                     limits= c(0,0.8)) +
  theme_cowplot(font_size = 8, line_size = 0.25) +
  theme(legend.position="none")
timecw

timeopp <- behavior %>%
  filter(APA2 %in% c("consistent","conflict")) %>%
    filter(TrainSessionComboNum %in% c("2", "3", "4")) %>% 
  ggplot(aes(x = as.numeric(TrainSessionComboNum), y = pTimeOPP, fill=APA2)) +
  geom_boxplot(outlier.size=0.8) +
  facet_wrap(~Genotype) +
  scale_fill_manual(values = c("#ca0020", "#f4a582")) + 
    scale_y_continuous(name = "Opposite the shock zone",
                       breaks = c(0,0.32, 0.64),
                     limits= c(0,0.8)) +
 scale_x_continuous(name="T1-T3 Average", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = NULL) +
  geom_hline(yintercept=c(0.32), color="black" , linetype="dashed") + 
  theme_cowplot(font_size = 8, line_size = 0.25) +
 theme(legend.position="none")
timeopp

timet <- behavior %>%
  filter(APA2 %in% c("consistent","conflict")) %>%
    filter(TrainSessionComboNum %in% c("2", "3", "4")) %>% 
  ggplot(aes(x = as.numeric(TrainSessionComboNum), y = pTimeTarget, fill=APA2)) +
  geom_boxplot(outlier.size=0.8) +
  facet_wrap(~Genotype) +
  scale_fill_manual(values = c("#ca0020", "#f4a582")) +  
 scale_x_continuous(name="T1-T3 Average", 
                       breaks = c(1, 2, 3, 4, 5, 6, 7, 8, 9),
                       labels = NULL) +
    scale_y_continuous(name = "Shock zone",
                       breaks = c(0,0.04, 0.08, 0.12),
                         limits= c(0,0.14)) +
  geom_hline(yintercept=c(0.04), color="black" , linetype="dashed") + 
  theme_cowplot(font_size = 8, line_size = 0.25) +
 theme(legend.position="none")
timet
```




# For Loops for Stats on Everything!! Not used for manuscript

```{r}
slim1 <- behavior[,c(2,4,8,13:52)]
slim2 <- slim1 %>% filter(TrainSession == "Hab") 
Genotype <- slim2[,1]
APA <- slim2[,3]
slim3 <- slim2[,c(4:43)]

for(y in names(slim3)){
  ymod<- summary(aov(slim3[[y]] ~ Genotype * APA))
  cat(paste('\nDependent var:', y, '\n'))
  print(ymod)
}
```